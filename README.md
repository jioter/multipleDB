# Multi-Database User Aggregation Service

This Spring Boot service aggregates user data from multiple databases and provides a single REST endpoint for retrieving user information across these data sources. The configuration allows for dynamic scaling, enabling the addition or removal of databases simply by updating the applicationâ€™s YAML configuration file.

***Note! This implementation only applicably for static colum names in different databases.***

## Features

- **Single REST Endpoint**: Aggregates user data from multiple databases accessible through a single endpoint.
- **Declarative Database Configuration**: Infinite support for data sources, defined in the `application.yaml`.
- **OpenAPI Specification**: The endpoint is documented with OpenAPI for clear contract definition.
- **Integration Tests**: Testcontainers support for reliable, isolated database testing.

## Quick Start

### Prerequisites

- **Java 17.0.12**
- **Maven 3.9.8**

### Setup

1. **Clone the Repository:**

   ```bash
   git clone https://github.com/jioter/multipleDB.git
   cd multipleDB

2. **Modify application.yaml to define your database sources. Example configuration:**
    ```yaml
    data-sources:
      data-sources:
        - name: data-base-1
          strategy: postgres
          url:  jdbc:postgresql://localhost:5432/db1
          table: users
          user: testuser
          password: testpass
          mapping:
              id: user_id
              username: login
              name: first_name
              surname: last_name
        - name: data-base-2 
          strategy: mysql
          url:  jdbc:mysql://localhost:3306/db2
          table: users
          user: testuser
          password: testpass
          mapping:
              id: user_id
              username: login
              name: first_name
              surname: last_name
         # Note! Only static field name mapping supported
         
3. **Build and run the application:**
   ```bash
   mvn clean install
   mvn spring-boot:run

4. Access the API documentation generated by OpenAPI:
   ```bash
   http://localhost:8080/swagger-ui.html

**Usage**

*Retrieve Users Across All Databases*

To fetch all users aggregated across databases:
    
    GET /users

**Example Response:**
```json
[
  {
    "id": 1,
    "username": "testUser1",
    "name": "Test",
    "surname": "User1"
  },
  {
    "id": 2,
    "username": "testUser2",
    "name": "Test",
    "surname": "User2"
  }
]

